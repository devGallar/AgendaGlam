"use strict";App.Pages.LegalSettings=function(){function isInvalid(){try{$("#legal-settings .is-invalid").removeClass("is-invalid");var missingRequiredFields=!1;if($("#legal-settings .required").each(function(index,requiredField){var $requiredField=$(requiredField);$requiredField.val()||($requiredField.addClass("is-invalid"),missingRequiredFields=!0)}),missingRequiredFields)throw new Error(lang("fields_are_required"));return!1}catch(error){return App.Layouts.Backend.displayNotification(error.message),!0}}function deserialize(legalSettings){legalSettings.forEach(function(legalSetting){"display_cookie_notice"===legalSetting.name&&$displayCookieNotice.prop("checked",!!+legalSetting.value),"cookie_notice_content"===legalSetting.name&&$cookieNoticeContent.trumbowyg("html",legalSetting.value),"display_terms_and_conditions"===legalSetting.name&&$displayTermsAndConditions.prop("checked",!!+legalSetting.value),"terms_and_conditions_content"===legalSetting.name&&$termsAndConditionsContent.trumbowyg("html",legalSetting.value),"display_privacy_policy"===legalSetting.name&&$displayPrivacyPolicy.prop("checked",!!+legalSetting.value),"privacy_policy_content"===legalSetting.name&&$privacyPolicyContent.trumbowyg("html",legalSetting.value)})}function serialize(){var legalSettings=[{name:"display_cookie_notice",value:$displayCookieNotice.prop("checked")?"1":"0"},{name:"cookie_notice_content",value:$cookieNoticeContent.trumbowyg("html")},{name:"display_terms_and_conditions",value:$displayTermsAndConditions.prop("checked")?"1":"0"},{name:"terms_and_conditions_content",value:$termsAndConditionsContent.trumbowyg("html")},{name:"display_privacy_policy",value:$displayPrivacyPolicy.prop("checked")?"1":"0"},{name:"privacy_policy_content",value:$privacyPolicyContent.trumbowyg("html")}];return legalSettings}function onSaveSettingsClick(){if(isInvalid())return void App.Layouts.Backend.displayNotification(lang("settings_are_invalid"));var legalSettings=serialize();App.Http.LegalSettings.save(legalSettings).done(function(){App.Layouts.Backend.displayNotification(lang("settings_saved"))})}var $saveSettings=$("#save-settings"),$displayCookieNotice=$("#display-cookie-notice"),$cookieNoticeContent=$("#cookie-notice-content"),$displayTermsAndConditions=$("#display-terms-and-conditions"),$termsAndConditionsContent=$("#terms-and-conditions-content"),$displayPrivacyPolicy=$("#display-privacy-policy"),$privacyPolicyContent=$("#privacy-policy-content");return document.addEventListener("DOMContentLoaded",function(){App.Utils.UI.initializeTextEditor($cookieNoticeContent),App.Utils.UI.initializeTextEditor($termsAndConditionsContent),App.Utils.UI.initializeTextEditor($privacyPolicyContent);var legalSettings=vars("legal_settings");deserialize(legalSettings),$saveSettings.on("click",onSaveSettingsClick)}),{}}();